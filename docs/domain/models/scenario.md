# Scenario Domain Model

## Overview

The `Scenario` domain model represents a complete interactive story/game scenario with scenes, characters, choices, and compass tracking.

## Class Definition

**Namespace**: `Mystira.App.Domain.Models`

**Location**: `src/Mystira.App.Domain/Models/Scenario.cs`

## Properties

| Property        | Type                      | Description                                    |
| --------------- | ------------------------- | ---------------------------------------------- |
| `Id`            | `string`                  | Unique identifier for the scenario             |
| `Title`         | `string`                  | Scenario title                                 |
| `Description`   | `string`                  | Scenario description                           |
| `Tags`          | `List<string>`            | Tags for categorization                        |
| `Difficulty`    | `DifficultyLevel`         | Difficulty level (Easy, Medium, Hard)          |
| `SessionLength` | `SessionLength`           | Estimated session length (Short, Medium, Long) |
| `Archetypes`    | `List<Archetype>`         | Character archetypes featured in scenario      |
| `AgeGroup`      | `string`                  | Target age group name                          |
| `MinimumAge`    | `int`                     | Minimum age requirement                        |
| `CoreAxes`      | `List<CoreAxis>`          | Compass axes tracked in this scenario          |
| `Characters`    | `List<ScenarioCharacter>` | Characters in the scenario                     |
| `Scenes`        | `List<Scene>`             | Scenes in the scenario                         |
| `CreatedAt`     | `DateTime`                | Creation timestamp                             |

## Methods

### `Validate(out List<string> errors)`

Validates the scenario structure:

- Checks title is not empty
- Validates scenes exist
- Validates scene references (NextSceneId, branch references)

**Returns**: `bool` - True if valid, false otherwise

**Errors**: Populates `errors` list with validation messages

## Related Domain Models

### ScenarioCharacter

Characters within the scenario.

**Properties**:

- `Id` - Character identifier
- `Name` - Character name
- `Image` - Image path (optional)
- `Audio` - Audio path (optional)
- `Metadata` - Character metadata

### ScenarioCharacterMetadata

Metadata for scenario characters.

**Properties**:

- `Role` - Character roles (list)
- `Archetype` - Character archetypes (list)
- `Species` - Character species
- `Age` - Character age
- `Traits` - Character traits (list)
- `Backstory` - Character backstory

### Scene

Individual scenes within a scenario.

**Properties**:

- `Id` - Scene identifier
- `Title` - Scene title
- `Type` - Scene type (Narrative, Choice, Roll, Special)
- `Description` - Scene description
- `NextSceneId` - Next scene ID (optional)
- `Media` - Media references (optional)
- `Branches` - List of branches/choices
- `EchoReveals` - List of echo reveals
- `Difficulty` - Scene difficulty (optional)

### Branch

Choices/branches in scenes.

**Properties**:

- `Choice` - Choice text
- `NextSceneId` - Next scene ID after choice
- `EchoLog` - Echo log generated by choice (optional)
- `CompassChange` - Compass change from choice (optional)

### EchoLog

Echo logs generated by choices.

**Properties**:

- `EchoType` - Type of echo (honesty, kindness, etc.)
- `Description` - Echo description
- `Strength` - Echo strength (0.1-1.0)
- `Timestamp` - When echo was generated

### CompassChange

Compass value changes from choices.

**Properties**:

- `Axis` - Compass axis name
- `Delta` - Change value (-1.0 to 1.0)
- `DevelopmentalLink` - Developmental link description (optional)

### EchoReveal

Echo reveal mechanics in scenes.

**Properties**:

- `EchoType` - Type of echo to reveal
- `MinStrength` - Minimum strength required
- `TriggerSceneId` - Scene ID that triggers reveal
- `MaxAgeScenes` - Maximum age of scenes to check
- `RevealMechanic` - Reveal mechanic type (optional)
- `Required` - Whether reveal is required (optional)

### MediaReferences

Media references in scenarios/scenes.

**Properties**:

- `Image` - Image path (optional)
- `Audio` - Audio path (optional)
- `Video` - Video path (optional)

## Enums

### DifficultyLevel

- `Easy`
- `Medium`
- `Hard`

### SessionLength

- `Short`
- `Medium`
- `Long`

### SceneType

- `Narrative` (0)
- `Choice` (1)
- `Roll` (2)
- `Special` (3)

## Parser Integration

Created by `ScenarioParser` from dictionary/YAML data:

- Parses top-level scenario fields
- Delegates to `CharacterParser` for characters
- Delegates to `SceneParser` for scenes

## Use Case Integration

Used in:

- `CreateScenarioUseCase` - Creates new scenarios
- `UpdateScenarioUseCase` - Updates existing scenarios
- `GetScenariosUseCase` - Retrieves scenarios with filtering
- `DeleteScenarioUseCase` - Deletes scenarios
- `ValidateScenarioUseCase` - Validates scenario structure

## Repository

Persisted through `IScenarioRepository`.

## Related Documentation

- [Parser Domain Object Verification](../../usecases/PARSER_IMPLEMENTATION_VERIFICATION.md)
- [Create Scenario Use Case](../../usecases/scenarios/create-scenario.md)
