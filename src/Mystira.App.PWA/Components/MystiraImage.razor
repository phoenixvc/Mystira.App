@inject IApiClient ApiClient
@inject ILogger<MystiraImage> Logger

<div class="@ContainerClass">
    @if (!string.IsNullOrEmpty(MediaId))
    {
        <img src="@GetFullImageUrl()"
             alt="@Alt"
             class="@ImageClass"
             width="@Width"
             height="@Height"
             loading="@Loading" />
    }
    else
    {
        <div class="text-danger">
            <small>No media ID specified</small>
        </div>
    }
</div>

@code {
    [Parameter] public string MediaId { get; set; } = "";
    [Parameter] public string Alt { get; set; } = "Image";
    [Parameter] public string ImageClass { get; set; } = "img-fluid";
    [Parameter] public string ContainerClass { get; set; } = "";
    [Parameter] public string Width { get; set; } = "auto";
    [Parameter] public string Height { get; set; } = "auto";
    [Parameter] public string Loading { get; set; } = "lazy";
    
    private string GetFullImageUrl()
    {
        // Construct the full URL to the API endpoint
        try
        {
            var baseUrl = ApiClient.GetApiBaseAddress();
            var apiUrl = $"{baseUrl}/api/media/{MediaId}";
            ApiClient.GetMediaUrlFromId(MediaId);
            return apiUrl;
        }
        catch (Exception ex)
        {
            Logger.LogError(ex, "MystiraImage component could not load image with Id {S}", MediaId);
            return string.Empty;
        }
    }
}